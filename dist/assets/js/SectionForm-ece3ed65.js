import{d as e,$ as o,e as s,k as t,f as a,ai as l,o as r,P as i,Q as p,a as m,c as n,a9 as u,K as d,V as f,M as c,u as v,T as j,J as h,L as x,F as y,aa as b}from"./@vue-2b5461a3.js";import{i as g,m as B,k as T,t as k,T as V,_ as F}from"./index-06b7404a.js";import"./dayjs-21617033.js";import{l as _}from"./lodash-8dc1f9dc.js";import{h as R}from"./_utils-e15a3336.js";import S from"./FooterBtns-ae106e98.js";import{d as $}from"./_config-7f8a0c8d.js";import"./element-plus-ee430b3a.js";import"./lodash-es-d4f5f48c.js";import"./@vueuse-2ec33eb0.js";import"./@element-plus-c17b3efe.js";import"./@popperjs-b78c3215.js";import"./@ctrl-91de2ec7.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-36fbce82.js";import"./qs-238f3f4b.js";import"./call-bind-ada3a9fc.js";import"./get-intrinsic-176af07e.js";import"./es-errors-c8ed318b.js";import"./has-symbols-456daba2.js";import"./has-proto-c2a23985.js";import"./function-bind-afbcd6f2.js";import"./hasown-c3b72c9b.js";import"./set-function-length-968dc075.js";import"./define-data-property-9d7bf764.js";import"./es-define-property-c2edbfb6.js";import"./gopd-16a4ddf0.js";import"./has-property-descriptors-52e43c9d.js";import"./side-channel-5a41c40a.js";import"./object-inspect-0d550a97.js";import"./axios-b9284f1b.js";import"./pinia-5cbb4d0f.js";import"./mock-04205f76.js";import"./mockjs-217213d3.js";import"./vue-router-7f68ddec.js";import"./nprogress-b5e58671.js";import"./vite-plugin-mock-6db8ade2.js";import"./path-to-regexp-83a43451.js";import"./system-ca7a6aa4.js";import"./xlsx-8a748b86.js";import"./index-194e202c.js";const q={class:"head f-sb-c"},P={class:"title f-fs-c"},w={class:"line-1"},C={key:1,class:"f-c-c pb-o"},N=F(e({name:"SectionForm",__name:"SectionForm",props:{modelValue:{default:()=>o({})},sections:{default:()=>[]},pureText:{type:Boolean},foldable:{type:Boolean,default:!0},fetch:{},fetchSuccess:{},fetchFail:{},footer:{type:Boolean,default:!0},span:{default:24},submitText:{},resetText:{},extraParams:{},moreBtns:{},loading:{type:Boolean},isOmit:{type:Boolean,default:!0},log:{type:Boolean,default:!g},debug:{type:Boolean},autoFixedFoot:{type:Boolean,default:!0},noSubmitProps:{},labelWidthBySection:{type:Boolean,default:!0},handleRequest:{}},emits:["update:modelValue","submit","change","moreBtns"],setup(e,{expose:o,emit:g}){const F=e,N=g,O=s(null),U=s([]),z=s(),I=s([]),W=t({get:()=>F.modelValue,set(e){N("update:modelValue",e)}}),A=t((()=>_.merge({},W.value,F.extraParams)));function J(){F.fetch?O.value.submit():N("submit",A.value)}return a((()=>F.sections),(e=>{const{modelValue:o,labelWidthBySection:s}=F;I.value=e.filter((e=>{if("Object"!==k(e))return!1;const{type:t,prop:a,fields:l,fieldAttrs:r}=e;if("Undefined"!==k(a)){const e=null==o?void 0:o[a];W.value[a]="custom"===t?e:R(l,N,e).data}else{const t=R(l,N,o,r);let{data:a,fields:i}=t;if(_.merge(W.value,a),s){const e=V(l);i=i.map(((o,s)=>(o.labelWidth=e+"em",o)))}e.fields=i}return!0}))}),{immediate:!0,deep:!0}),o({formRef:z,formValidate:()=>O.value.formValidate()}),(e,o)=>{const s=l("BaseIcon"),t=l("el-popover"),a=l("BaseFormItem"),g=l("el-form");return r(),i(g,c({class:"section-form f-fs-s-c",model:W.value},v($),{onKeyup:b(J,["enter"]),ref_key:"formRef",ref:z}),{default:p((()=>[m("div",{class:d(["all-hide-scroll f-fs-s-w",{"auto-fixed-foot":e.autoFixedFoot}])},[I.value.length?(r(!0),n(y,{key:0},u(I.value,((l,b)=>(r(),n("section",{class:d(["section",{[`f-span-${l.span??24}`]:!0}]),key:b},[m("div",q,[m("div",P,[m("span",w,f(l.title),1),l.popover?(r(),i(t,c({key:0,ref_for:!0},v(B)(l.popover)),{reference:p((()=>[l.popover?(r(),i(s,{key:0,color:v(T).colorInfo,class:"ml-q",name:"QuestionFilled"},null,8,["color"])):j("",!0)])),_:2},1040)):j("",!0)]),h(e.$slots,"right-"+(l.prop??b),{},void 0,!0),e.foldable?(r(),i(s,{key:0,onClick:e=>U.value[b]=!U.value[b],class:d(["fold-btn f-0",U.value[b]?"rotate-180":""]),size:"1.5em",name:"CaretTop"},null,8,["onClick","class"])):j("",!0)]),m("div",{class:"body f-fs-fs-w",style:x({"max-height":U.value[b]?"0":"100vh"})},["custom"===l.type?h(e.$slots,l.prop,{key:0,form:W.value},void 0,!0):(r(!0),n(y,{key:1},u(l.fields,((s,t)=>{var m,u,d,f,c;return r(),n(y,{key:(null==s?void 0:s.key)??t},[l.prop?(r(),i(a,{key:0,className:`f-span-${(null==(m=s.extra)?void 0:m.span)||e.span}`,field:s,pureText:(null==(u=null==s?void 0:s.extra)?void 0:u.pureText)||l.pureText||e.pureText,modelValue:W.value[l.prop][s.prop],"onUpdate:modelValue":e=>W.value[l.prop][s.prop]=e,onChange:o[0]||(o[0]=(e,o)=>N("change",e,o)),formRef:z.value},{custom:p((({field:o})=>[h(e.$slots,o.prop,{field:o,form:W.value},void 0,!0)])),_:2},1032,["className","field","pureText","modelValue","onUpdate:modelValue","formRef"])):(r(),i(a,{key:1,className:`f-span-${(null==(d=null==s?void 0:s.extra)?void 0:d.span)||e.span}`,field:s,pureText:(null==(f=null==s?void 0:s.extra)?void 0:f.pureText)||(null==(c=null==l?void 0:l.extra)?void 0:c.pureText)||e.pureText,modelValue:W.value[s.prop],"onUpdate:modelValue":e=>W.value[s.prop]=e,onChange:o[1]||(o[1]=(e,o)=>N("change",e,o)),formRef:z.value},{custom:p((({field:o})=>[h(e.$slots,o.prop,{field:o,form:W.value},void 0,!0)])),_:2},1032,["className","field","pureText","modelValue","onUpdate:modelValue","formRef"]))],64)})),128))],4)],2)))),128)):(r(),n("div",C,"空空如也~"))],2),!e.pureText&&e.footer?(r(),i(S,{key:0,loading:e.loading,moreBtns:e.moreBtns,submitText:e.submitText,resetText:e.resetText,formRef:z.value,isOmit:e.isOmit,log:e.log,debug:e.debug,params:A.value,fetch:e.fetch,fetchSuccess:e.fetchSuccess,fetchFail:e.fetchFail,noSubmitProps:e.noSubmitProps,handleRequest:e.handleRequest,disabled:!I.value.length,onMoreBtns:o[2]||(o[2]=(e,o,s)=>N("moreBtns",e,o,s)),onSubmit:o[3]||(o[3]=e=>N("submit",e)),ref_key:"footerBtnsRef",ref:O},null,8,["loading","moreBtns","submitText","resetText","formRef","isOmit","log","debug","params","fetch","fetchSuccess","fetchFail","noSubmitProps","handleRequest","disabled"])):j("",!0)])),_:3},16,["model"])}}}),[["__scopeId","data-v-60c08a1c"]]);export{N as default};
