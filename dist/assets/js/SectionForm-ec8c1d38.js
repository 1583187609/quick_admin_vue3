import{d as e,$ as o,e as t,k as s,f as a,ai as l,o as r,P as i,Q as p,a as m,c as n,a9 as u,K as d,V as f,M as c,u as v,T as j,J as h,L as x,F as y,aa as b}from"./@vue-2b5461a3.js";import{i as g,m as k,k as B,t as T,Q as V,_ as F}from"./index-df51bfa3.js";import"./dayjs-70c6b0b9.js";import{l as _}from"./lodash-e3f0fdcb.js";import{h as R}from"./_utils-0f2b9537.js";import S from"./FooterBtns-c1c5d07a.js";import{d as P}from"./_config-f68c3c0a.js";import"./element-plus-568f2232.js";import"./lodash-es-d4f5f48c.js";import"./@vueuse-2ec33eb0.js";import"./@element-plus-df896130.js";import"./@popperjs-b78c3215.js";import"./@ctrl-91de2ec7.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-36fbce82.js";import"./qs-349681aa.js";import"./call-bind-2df1f9b5.js";import"./get-intrinsic-176af07e.js";import"./es-errors-c8ed318b.js";import"./has-symbols-456daba2.js";import"./has-proto-c2a23985.js";import"./function-bind-afbcd6f2.js";import"./hasown-c3b72c9b.js";import"./set-function-length-af5653fd.js";import"./define-data-property-80a6b8d7.js";import"./es-define-property-c2edbfb6.js";import"./gopd-991ce5b0.js";import"./has-property-descriptors-52e43c9d.js";import"./side-channel-4fcbcfeb.js";import"./object-inspect-1fd817f8.js";import"./axios-b9284f1b.js";import"./pinia-5cbb4d0f.js";import"./mock-281f81b0.js";import"./mockjs-21e11712.js";import"./vue-router-27db6c8e.js";import"./nprogress-61860a65.js";import"./vite-plugin-mock-fcfbfb18.js";import"./path-to-regexp-83a43451.js";import"./vue-i18n-aaa7cda4.js";import"./@intlify-34459bb4.js";import"./xlsx-8a748b86.js";import"./index-ab647bfb.js";const $={class:"head f-sb-c"},q={class:"title f-fs-c"},C={class:"line-1"},w={key:1,class:"f-c-c pb-o"},N=F(e({name:"SectionForm",__name:"SectionForm",props:{modelValue:{default:()=>o({})},sections:{default:()=>[]},pureText:{type:Boolean},foldable:{type:Boolean,default:!0},fetch:{},fetchSuccess:{},fetchFail:{},footer:{type:Boolean,default:!0},span:{default:24},submitText:{},resetText:{},extraParams:{},moreBtns:{},loading:{type:Boolean},isOmit:{type:Boolean,default:!0},log:{type:Boolean,default:!g},debug:{type:Boolean},autoFixedFoot:{type:Boolean,default:!0},noSubmitProps:{},labelWidthBySection:{type:Boolean,default:!0},handleRequest:{}},emits:["update:modelValue","submit","change","moreBtns"],setup(e,{expose:o,emit:g}){const F=e,N=g,O=t(null),U=t([]),I=t(),M=t([]),z=s({get:()=>F.modelValue,set(e){N("update:modelValue",e)}}),K=s((()=>_.merge({},z.value,F.extraParams)));function Q(){F.fetch?O.value.submit():N("submit",K.value)}return a((()=>F.sections),(e=>{const{modelValue:o,labelWidthBySection:t}=F;M.value=e.filter((e=>{if("Object"!==T(e))return!1;const{type:s,prop:a,fields:l,fieldAttrs:r}=e;if("Undefined"!==T(a)){const e=null==o?void 0:o[a];z.value[a]="custom"===s?e:R(l,N,e).data}else{const s=R(l,N,o,r);let{fields:a}=s;const{data:i}=s;if(_.merge(z.value,i),t){const e=V(l);a=a.map(((o,t)=>(o.labelWidth=e+"em",o)))}e.fields=a}return!0}))}),{immediate:!0,deep:!0}),o({formRef:I,formValidate:()=>O.value.formValidate()}),(e,o)=>{const t=l("BaseIcon"),s=l("el-popover"),a=l("BaseFormItem"),g=l("el-form");return r(),i(g,c({class:"section-form f-fs-s-c",model:z.value},v(P),{onKeyup:b(Q,["enter"]),ref_key:"formRef",ref:I}),{default:p((()=>[m("div",{class:d(["all-hide-scroll f-fs-s-w",{"auto-fixed-foot":e.autoFixedFoot}])},[M.value.length?(r(!0),n(y,{key:0},u(M.value,((l,b)=>(r(),n("section",{class:d(["section",{[`f-span-${l.span??24}`]:!0}]),key:b},[m("div",$,[m("div",q,[m("span",C,f(l.title),1),l.popover?(r(),i(s,c({key:0,ref_for:!0},v(k)(l.popover)),{reference:p((()=>[l.popover?(r(),i(t,{key:0,color:v(B).colorInfo,class:"ml-q",name:"QuestionFilled"},null,8,["color"])):j("",!0)])),_:2},1040)):j("",!0)]),h(e.$slots,"right-"+(l.prop??b),{},void 0,!0),e.foldable?(r(),i(t,{key:0,onClick:e=>U.value[b]=!U.value[b],class:d(["fold-btn f-0",U.value[b]?"rotate-180":""]),size:"1.5em",name:"CaretTop"},null,8,["onClick","class"])):j("",!0)]),m("div",{class:"body f-fs-fs-w",style:x({"max-height":U.value[b]?"0":"100vh"})},["custom"===l.type?h(e.$slots,l.prop,{key:0,form:z.value},void 0,!0):(r(!0),n(y,{key:1},u(l.fields,((t,s)=>{var m,u,d,f,c;return r(),n(y,{key:(null==t?void 0:t.key)??s},[l.prop?(r(),i(a,{key:0,className:`f-span-${(null==(m=t.extra)?void 0:m.span)||e.span}`,field:t,pureText:(null==(u=null==t?void 0:t.extra)?void 0:u.pureText)||l.pureText||e.pureText,modelValue:z.value[l.prop][t.prop],"onUpdate:modelValue":e=>z.value[l.prop][t.prop]=e,onChange:o[0]||(o[0]=(e,o)=>N("change",e,o)),formRef:I.value},{custom:p((({field:o})=>[h(e.$slots,o.prop,{field:o,form:z.value},void 0,!0)])),_:2},1032,["className","field","pureText","modelValue","onUpdate:modelValue","formRef"])):(r(),i(a,{key:1,className:`f-span-${(null==(d=null==t?void 0:t.extra)?void 0:d.span)||e.span}`,field:t,pureText:(null==(f=null==t?void 0:t.extra)?void 0:f.pureText)||(null==(c=null==l?void 0:l.extra)?void 0:c.pureText)||e.pureText,modelValue:z.value[t.prop],"onUpdate:modelValue":e=>z.value[t.prop]=e,onChange:o[1]||(o[1]=(e,o)=>N("change",e,o)),formRef:I.value},{custom:p((({field:o})=>[h(e.$slots,o.prop,{field:o,form:z.value},void 0,!0)])),_:2},1032,["className","field","pureText","modelValue","onUpdate:modelValue","formRef"]))],64)})),128))],4)],2)))),128)):(r(),n("div",w,"空空如也~"))],2),!e.pureText&&e.footer?(r(),i(S,{key:0,loading:e.loading,moreBtns:e.moreBtns,submitText:e.submitText,resetText:e.resetText,formRef:I.value,isOmit:e.isOmit,log:e.log,debug:e.debug,params:K.value,fetch:e.fetch,fetchSuccess:e.fetchSuccess,fetchFail:e.fetchFail,noSubmitProps:e.noSubmitProps,handleRequest:e.handleRequest,disabled:!M.value.length,onMoreBtns:o[2]||(o[2]=(e,o,t)=>N("moreBtns",e,o,t)),onSubmit:o[3]||(o[3]=e=>N("submit",e)),ref_key:"footerBtnsRef",ref:O},null,8,["loading","moreBtns","submitText","resetText","formRef","isOmit","log","debug","params","fetch","fetchSuccess","fetchFail","noSubmitProps","handleRequest","disabled"])):j("",!0)])),_:3},16,["model"])}}}),[["__scopeId","data-v-54f2d959"]]);export{N as default};
