import{l as e}from"./lodash-e3f0fdcb.js";import{t,E as o,F as s,r,k as n,s as l,q as a}from"./index-df51bfa3.js";import{g as i}from"./index-ab647bfb.js";import c from"./ImportPopup-34a61de7.js";import{d as p}from"./element-plus-568f2232.js";import{ah as u}from"./@vue-2b5461a3.js";const d=["delete","export","pass","reject","repeal","enable","forbid","download"],m=[void 0,"index","id","create","update","remark"];function f({btnObj:o,cols:s,seledRows:r,seledKeys:a,total:i,exportCfg:f,emits:g,next:b,openPopup:x,importCfg:y}){const{name:v="",text:h,attrs:j,customRules:$}=o;if($)return g("extraBtn",v,b,{selectedKeys:[],selectedRows:[],exportRows:[]});const w=(null==j?void 0:j.type)||"primary",B=`color${e.upperFirst(w)}`,R=n[B];if(d.includes(v)){const e=r.length===i,o=r.length>f.limit;if(["export"].includes(v)&&o)l({message:`单次${h}不能超过 <b>${f.limit}</b> 条，请缩小查询范围！`,dangerouslyUseHTMLString:!0},"warning");else{const o=`确定 <b style="color:${R};">${h}${e?"全部</b> ":"</b>"} 共 <b style="color:${R};">${r.length}</b> 条记录？`;p.confirm(o,"温馨提示",{type:"delete"===v?"error":"warning",dangerouslyUseHTMLString:!0,closeOnClickModal:!1,confirmButtonText:"确定",cancelButtonText:"取消",confirmButtonClass:`el-button--${w}`,cancelButtonClass:`el-button--${w} is-plain`,draggable:!0}).then((()=>{const e=[];if("export"===v){const o=(null==s?void 0:s.filter((e=>{var o;return"Object"===t(e)&&!(null==(o=null==e?void 0:e.prop)?void 0:o.startsWith("$"))})))||[];e.push(o.map((e=>e.label))),r.forEach((t=>{const s=[];o.forEach((e=>{const{prop:o,type:r,formatter:n}=e;let l="";m.includes(r)&&(l=n?n(t):t[o]??""),s.push(l)})),e.push(s)}))}g("extraBtn",v,b,{selectedKeys:a,selectedRows:r,exportRows:e})})).catch((()=>{}))}}else"import"===v?x("温馨提示",u(c,{tplCfg:y,onChange:e=>g("click",v,e)})):g("extraBtn",v,b,{selectedKeys:[],selectedRows:[],exportRows:[]})}function g(e,t){var o,s;const{groupBtns:r,cols:n=[]}=t;if("operate"===e)return r&&"operate"!==(null==(s=null==(o=n.slice(-1))?void 0:o[0])?void 0:s.type);return t[e]&&!n.find((t=>t.type===e))}function b(e,n){const{attrs:l,type:i=a,options:c=[]}=e;if("cascader"===i)return"Array"===t(n)?o(c,n):s(c,n);if("select"===i){if(null==l?void 0:l.multiple){return c.filter((e=>n.includes(e.value))).map((e=>e.label)).join("、")}return s(c,n)}return"BaseNumberRange"===i||"date-picker"===i?null==n?void 0:n.join(r):n}function x(e,o,s){var r;const n="Function"===t(s)?s(e,o):s;return(null==(r=null==n?void 0:n.map((t=>i(t,e))))?void 0:r.filter((e=>!!e.name)))??[]}export{x as a,d as b,b as g,f as h,g as n};
