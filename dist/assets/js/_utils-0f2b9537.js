import{t as n,L as r,p as t}from"./index-df51bfa3.js";import{l as e}from"./lodash-e3f0fdcb.js";function o(r,t){if(!t)return;const{attrs:l,children:i}=r,{attrs:a,...d}=t;r.attrs=l?e.merge({},a,l):a,null==i||i.forEach((r=>{if("Object"!==n(r))return!1;o(r,t)})),e.merge(r,d,JSON.parse(JSON.stringify(r)))}function l(r){const t={};return null==r||r.map((r=>{if("Object"!==n(r))return;const{prop:e}=r;t[e]=void 0})),t}function i(e=[],a,d,s){const c={data:{},fields:[]};return e.forEach(((e,u)=>{if("Object"!==n(e))return null;const{type:f,prop:p,children:h}=e,v=n(p);if(r(e,d),"String"===v){let n=null==d?void 0:d[p];if("checkbox"===f&&void 0===n)n=!1;else if("addDel"===f)c.data[p]=(null==n?void 0:n.length)?n:[l(h)];else{const r=(null==h?void 0:h.length)?i(h,a,n).data:n;c.data[p]=r,void 0!==r&&(null==a||a("change",p,r))}}else if("Array"===v){const[n,r]=p,o=null==d?void 0:d[r],l=null==d?void 0:d[n],i=p.join(t),s=void 0===l&&void 0===o?void 0:[l,o];c.data[i]=s,e.prop=i,void 0!==s&&(null==a||a("change",i,s))}else{if("Undefined"!==v)throw new Error(`暂未处理prop为${v}类型的值`);if(!h)throw new Error("不能同时没有prop和children属性");if(h.length){const n={},r=h.map((r=>{const{prop:t}=r;return n[t]=null==d?void 0:d[t],t})).join(t),o=n;e.prop=r,c.data[r]=o,Object.keys(o).length&&(null==a||a("change",r,o))}}o(e,s),(null==h?void 0:h.length)&&(null==h||h.forEach((r=>{if("Object"!==n(r))return!1}))),c.fields.push(e)})),c}export{l as g,i as h};
